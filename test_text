import smbclient

# FSx Configuration
fsx_ip = "10.152.10.123"
share_name = "share_1"
folder_name = "test_folder"
domain = "YOUR_DOMAIN"
username = "YOUR_USERNAME"
password = "YOUR_PASSWORD"

# Configure SMB Client
smbclient.ClientConfig(username=username, password=password, domain=domain)

def list_files_in_share():
    try:
        share_path = f"\\\\{fsx_ip}\\{share_name}\\{folder_name}"
        files = smbclient.listdir(share_path)
        print(f"Files in {folder_name}: {files}")
    except Exception as e:
        print(f"Error listing files: {e}")
        raise

if __name__ == "__main__":
    list_files_in_share()
