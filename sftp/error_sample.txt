import requests
import json
import base64

def encode_file_to_base64(filepath):
    """Read file and encode its contents to base64."""
    with open(filepath, "rb") as file:
        encoded_string = base64.b64encode(file.read()).decode('utf-8')
    return encoded_string

# Define the URL and headers
url = 'https://hf-edr-services-rt.us-e1.cloudhub.io/v1/documents'
headers = {
    'client_id': '{{applicationId}}',  # Replace '{{applicationId}}' with your actual application ID
    'Content-Type': 'application/json'
}

# Encode the PDF file to base64
file_path = 'DEV-12055127.pdf'  # Ensure this path points to the correct file
document_stream = encode_file_to_base64(file_path)

# Define the JSON data payload
data = {
    "DocumentProperties": {
        "CustomerType": "Provider",
        "DocumentCategory": "Payment_Integrity_Letter",
        "DocumentTypeName": "Subrogation_Letter",
        "DocumentDate": "2021-07-23",
        "DocumentID": "DEV-12055127",
        "DocumentName": "DEV-12055127.pdf",
        "Description": "DHP Letters data updated"
    },
    "DocumentContent": {
        "DocumentStream": document_stream
    },
    "DocumentAttribute": [
        {
            "AttributeName": "hf:Provider_ID",
            "AttributeValue": "1234"
        }
    ]
}

# Convert the data dictionary to a JSON formatted string
json_data = json.dumps(data)

# Send the POST request
response = requests.post(url, headers=headers, data=json_data)

# Check the response
if response.status_code == 200:
    print("Request successful:", response.text)
else:
    print("Failed to send request. Status code:", response.status_code, "Response:", response.text)
